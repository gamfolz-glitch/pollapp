{% extends "dashboard/base.html" %}

{% block dashboard_title %}{{ title }}{% endblock %}

{% block dashboard_content %}
  <div class="max-w-2xl mx-auto animate-fade-in">
    <!-- Back Button -->
    <a href="{% url 'polls:project_detail' poll_id=poll.id %}" 
       class="text-indigo-600 hover:text-indigo-700 mb-6 inline-flex items-center gap-2 transition-colors">
      <i class="fas fa-arrow-left"></i>
      <span>–ù–∞–∑–∞–¥ –∫ –æ–ø—Ä–æ—Å—É</span>
    </a>

    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold gradient-text mb-2">{{ title }}</h1>
      <p class="text-gray-600">
        –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –≤ –æ–ø—Ä–æ—Å: <strong>{{ poll.title }}</strong>
      </p>
    </div>

    <!-- Form -->
    <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-8 card-hover">
      <form method="post">
        {% csrf_token %}

        {% if form.errors %}
          <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-lg mb-6">
            <strong class="text-red-800 block mb-2">–ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏:</strong>
            <ul class="text-red-700 text-sm space-y-1">
              {% for field in form %}
                {% for error in field.errors %}
                  <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                {% endfor %}
              {% endfor %}
              {% for error in form.non_field_errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          </div>
        {% endif %}

        <!-- Question Text -->
        <div class="mb-6">
          <label for="{{ form.text.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-2">
            –¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ *
          </label>
          <textarea 
            name="text" 
            id="{{ form.text.id_for_label }}"
            required
            rows="3"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-200 transition-all input-focus resize-none"
            placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞"
          >{{ form.text.value|default:'' }}</textarea>
          {% if form.text.help_text %}
            <p class="text-xs text-gray-500 mt-2">{{ form.text.help_text }}</p>
          {% endif %}
        </div>

        <!-- Question Type -->
        <div class="mb-6">
          <label for="{{ form.kind.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-2">
            –¢–∏–ø –≤–æ–ø—Ä–æ—Å–∞ *
          </label>
          <select 
            name="kind" 
            id="{{ form.kind.id_for_label }}"
            required
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-200 transition-all input-focus"
          >
            {% for value, label in form.kind.field.choices %}
              <option value="{{ value }}" {% if form.kind.value == value %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
          <p class="text-xs text-gray-500 mt-2">
            <strong>–¢–µ–∫—Å—Ç</strong> ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç.<br>
            <strong>–û–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä</strong> ‚Äî –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç.<br>
            <strong>–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä</strong> ‚Äî –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.
          </p>
        </div>

        <!-- Test Question -->
        <div class="mb-8 p-4 border-2 border-gray-200 rounded-xl bg-gray-50">
          <label class="flex items-center gap-3 cursor-pointer">
            <input 
              type="checkbox" 
              name="is_test_question" 
              id="{{ form.is_test_question.id_for_label }}"
              {% if form.is_test_question.value %}checked{% endif %}
              class="w-5 h-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
            />
            <div>
              <span class="block text-sm font-semibold text-gray-700 mb-1">
                üß™ –¢–µ—Å—Ç–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å
              </span>
              <span class="text-xs text-gray-500">
                –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ ‚Äî –ø—Ä–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –æ–ø—Ä–æ—Å–∞ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ—Ç–≤–µ—Ç–∏–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.<br>
                <strong>–í–∞–∂–Ω–æ:</strong> —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤ (¬´–û–¥–∏–Ω¬ª –∏–ª–∏ ¬´–ù–µ—Å–∫–æ–ª—å–∫–æ¬ª).
              </span>
            </div>
          </label>
        </div>

        <!-- Buttons -->
        <div class="flex gap-4 justify-center">
          <button type="submit" class="btn-gradient text-white px-8 py-3 rounded-xl font-semibold flex items-center gap-2 shadow-lg group">
            <i class="fas fa-save group-hover:scale-110 transition-transform"></i>
            <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–æ–ø—Ä–æ—Å</span>
          </button>
          <a href="{% url 'polls:project_detail' poll_id=poll.id %}" 
             class="bg-white border-2 border-gray-300 text-gray-700 px-8 py-3 rounded-xl hover:border-gray-400 transition-all font-semibold">
            –û—Ç–º–µ–Ω–∞
          </a>
        </div>
      </form>
    </div>
  </div>
{% endblock %}