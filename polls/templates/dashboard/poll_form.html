{% extends "dashboard/base.html" %}

{% block dashboard_title %}{{ title }}{% endblock %}

{% block dashboard_content %}
  <div class="max-w-2xl mx-auto animate-fade-in">
    <!-- Back Button -->
    <a href="{% if poll %}{% url 'polls:project_detail' poll_id=poll.id %}{% else %}{% url 'polls:project_list' %}{% endif %}" 
       class="text-indigo-600 hover:text-indigo-700 mb-6 inline-flex items-center gap-2 transition-colors">
      <i class="fas fa-arrow-left"></i>
      <span>–ù–∞–∑–∞–¥</span>
    </a>

    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold gradient-text mb-2">{{ title }}</h1>
      <p class="text-gray-600">
        {% if poll %}
          –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: <strong>{{ poll.title }}</strong>
        {% else %}
          –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –æ–ø—Ä–æ—Å –∏ –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
        {% endif %}
      </p>
    </div>

    <!-- Form -->
    <div class="bg-white rounded-2xl shadow-lg border border-gray-200 p-8 card-hover">
      <form method="post">
        {% csrf_token %}

        {% if form.errors %}
          <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded-lg mb-6">
            <strong class="text-red-800 block mb-2">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏:</strong>
            <ul class="text-red-700 text-sm space-y-1">
              {% for field in form %}
                {% for error in field.errors %}
                  <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                {% endfor %}
              {% endfor %}
            </ul>
          </div>
        {% endif %}

        <!-- Title -->
        <div class="mb-6">
          <label for="{{ form.title.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-2">
            –ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ *
          </label>
          <input 
            type="text" 
            name="title" 
            id="{{ form.title.id_for_label }}"
            value="{{ form.title.value|default:'' }}"
            required
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-200 transition-all input-focus"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û–ø—Ä–æ—Å –ø–æ Python"
          />
        </div>

        <!-- Description -->
        <div class="mb-6">
          <label for="{{ form.description.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-2">
            –û–ø–∏—Å–∞–Ω–∏–µ
          </label>
          <textarea 
            name="description" 
            id="{{ form.description.id_for_label }}"
            rows="3"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-200 transition-all input-focus resize-none"
            placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
          >{{ form.description.value|default:'' }}</textarea>
        </div>

        <!-- Time Limit -->
        <div class="mb-6">
          <label for="{{ form.time_limit_minutes.id_for_label }}" class="block text-sm font-semibold text-gray-700 mb-2">
            –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (–º–∏–Ω—É—Ç—ã)
          </label>
          <input 
            type="number" 
            name="time_limit_minutes" 
            id="{{ form.time_limit_minutes.id_for_label }}"
            value="{{ form.time_limit_minutes.value|default:'' }}"
            min="1"
            class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-200 transition-all input-focus"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 5"
          />
          {% if form.time_limit_minutes.help_text %}
            <p class="text-xs text-gray-500 mt-2">{{ form.time_limit_minutes.help_text }}</p>
          {% endif %}
          {% if poll and poll.has_time_limit %}
            <p class="text-sm text-emerald-600 mt-2 font-semibold">
               –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: {{ poll.get_time_limit_display }}
            </p>
          {% elif poll %}
            <p class="text-sm text-gray-500 mt-2">
              üü¢ –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
            </p>
          {% endif %}
        </div>

        <!-- Allow Multiple Submissions -->
        <div class="mb-8">
          <label class="flex items-start gap-3 cursor-pointer">
            <input 
              type="checkbox" 
              name="allow_multiple_submissions" 
              id="{{ form.allow_multiple_submissions.id_for_label }}"
              {% if form.allow_multiple_submissions.value %}checked{% endif %}
              class="mt-1 w-5 h-5 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"
            />
            <div>
              <span class="block text-sm font-semibold text-gray-700 mb-1">
                –†–∞–∑—Ä–µ—à–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–ø—Ä–æ—Å–∞
              </span>
              <span class="text-xs text-gray-500">
                –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω–æ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –∞–Ω–æ–Ω–∏–º —Å–º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ –æ–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.
              </span>
            </div>
          </label>
        </div>

        <!-- Buttons -->
        <div class="flex gap-4 justify-center">
          <button type="submit" class="btn-gradient text-white px-8 py-3 rounded-xl font-semibold flex items-center gap-2 shadow-lg group">
            <i class="fas fa-save group-hover:scale-110 transition-transform"></i>
            <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–ø—Ä–æ—Å</span>
          </button>
          <a href="{% if poll %}{% url 'polls:project_detail' poll_id=poll.id %}{% else %}{% url 'polls:project_list' %}{% endif %}" 
             class="bg-white border-2 border-gray-300 text-gray-700 px-8 py-3 rounded-xl hover:border-gray-400 transition-all font-semibold">
            –û—Ç–º–µ–Ω–∞
          </a>
        </div>
      </form>
    </div>
  </div>
{% endblock %}